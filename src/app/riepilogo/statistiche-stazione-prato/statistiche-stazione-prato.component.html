<br>
<mat-spinner *ngIf="imageLoader" mode="indeterminate"></mat-spinner>
<br>
<h1> Riepilogo Stazione Meteo Campoli Loc Prato - 586 mt </h1>
<br>
<div [hidden]="imageLoader" *ngIf="isVisible">
  <div class="mat-elevation-z8 table-riepilogo-stazione-prato center">
    <!-- Selettore per il mese -->
    <!-- app.component.html -->
    <mat-form-field appearance="fill">
      <mat-label>Seleziona mese ed anno</mat-label>
      <input matInput [matDatepicker]="picker" [formControl]="dateControl" readonly>
      <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
      <mat-datepicker #picker startView="multi-year" (yearSelected)="chosenYearHandler($event, picker)"
                      (monthSelected)="chosenMonthHandler($event, picker)" panelClass="month-year-picker">
      </mat-datepicker>
    </mat-form-field>

    <button mat-raised-button color="primary" class="esegui" (click)="filterData()">ESEGUI</button>

    <!--<table mat-table [dataSource]="filteredData">
      &lt;!&ndash; Esempio di colonna &ndash;&gt;
      <ng-container matColumnDef="colonna1">
        <th mat-header-cell *matHeaderCellDef> Colonna 1 </th>
        <td mat-cell *matCellDef="let row"> {{row.colonna1}} </td>
      </ng-container>

      &lt;!&ndash; Header e righe della tabella &ndash;&gt;
      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
    </table>-->

    <!--<mat-form-field appearance="standard">
      <mat-label>Filter</mat-label>
      <input matInput (keyup)="applyFilter($event)" placeholder="Ex. Mia" #input>
    </mat-form-field>-->

    <h2 class="title-micro-section">{{getMonthName(month) + " " + year}} </h2>


    <table mat-table [dataSource]="dataSource" class="mat-elevation-z8" matSort>

      <!-- Data Ora Column -->
      <ng-container matColumnDef="giorno">
        <th class="riepilogo-giorno-header" mat-header-cell *matHeaderCellDef mat-sort-header> Giorno</th>
        <td class="riepilogo-giorno-body" mat-cell *matCellDef="let element" [ngStyle]="{'background-color': element?.giorno === 'Totale' ? 'rgb(159 153 153)' : '#e3dede'} "> {{(element?.giorno) ? element?.giorno : '-' }} </td>
      </ng-container>

      <!-- Profondita Column -->
      <ng-container matColumnDef="tempMin">
        <th class="riepilogo-temMin-header" mat-header-cell *matHeaderCellDef mat-sort-header> Temperatura Minima</th>
        <td class="riepilogo-temMin-body" mat-cell *matCellDef="let element" [ngStyle]="{'background-color': element?.giorno === 'Totale' ? 'rgb(159 153 153)' : getCellColor(element?.tempMin)}"> {{(element?.tempMin) ? element?.tempMin + '°' : '-' }} </td>
      </ng-container>

      <!-- Zona Column -->
      <ng-container matColumnDef="tempMax">
        <th class="riepilogo-temMax-header" mat-header-cell *matHeaderCellDef mat-sort-header> Temperatura Massima</th>
        <td class="riepilogo-temMax-body" mat-cell *matCellDef="let element" [ngStyle]="{'background-color': element?.giorno === 'Totale' ? 'rgb(159 153 153)' : getCellColor(element?.tempMax)}"> {{(element?.tempMax) ? element?.tempMax + '°' : '-' }} </td>
      </ng-container>

      <!-- Profondita Column -->
      <ng-container matColumnDef="tempMedia">
        <th class="riepilogo-temMedia-header" mat-header-cell *matHeaderCellDef mat-sort-header> Temperatura Media</th>
        <td class="riepilogo-temMedia-body" mat-cell *matCellDef="let element" [ngStyle]="{'background-color': element?.giorno === 'Totale' ? 'rgb(159 153 153)' : getCellColor(element?.tempMedia)}"> {{(element?.tempMedia && element?.tempMedia !== 'NaN') ? element?.tempMedia + '°' : '-' }} </td>
      </ng-container>

      <!-- Magnitudo Column -->
      <ng-container matColumnDef="vento">
        <th class="riepilogo-vento-header" mat-header-cell *matHeaderCellDef mat-sort-header> Vento Raffica Max</th>
        <td class="riepilogo-vento-body" mat-cell *matCellDef="let element" [ngStyle]="{'background-color': element?.giorno === 'Totale' ? 'rgb(159 153 153)' : getVentoColor(element?.ventoMax)}"> {{(element?.ventoMax) ? element?.ventoMax + ' Km/h' : '-' }} </td>
      </ng-container>

      <!-- Magnitudo Column -->
      <ng-container matColumnDef="umidita">
        <th class="riepilogo-vento-header" mat-header-cell *matHeaderCellDef mat-sort-header> Umidità</th>
        <td class="riepilogo-vento-body" mat-cell *matCellDef="let element" [ngStyle]="{'background-color': element?.giorno === 'Totale' ? 'rgb(159 153 153)' : getUmiditaColor(element?.umidita)}"> {{(element?.umidita) ? element?.umidita + ' %' : '-' }} </td>
      </ng-container>

      <!-- Magnitudo Column -->
      <ng-container matColumnDef="pioggia">
        <th class="riepilogo-pioggia-header" mat-header-cell *matHeaderCellDef mat-sort-header> Pioggia</th>
        <td class="riepilogo-pioggia-body" mat-cell *matCellDef="let element" [ngStyle]="{'background-color': element?.giorno === 'Totale' ? 'rgb(159 153 153)' : getPioggiaColor(element?.pioggia)}"> {{(element?.pioggia) ? element?.pioggia + ' mm' : '0.0 mm' }} </td>
      </ng-container>


      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>

      <!-- Row shown when there is no matching data. -->
      <tr class="mat-row" *matNoDataRow>
        <td class="mat-cell red" colspan="7">Nessun dato disponibile </td>
      </tr>
    </table>
    <mat-paginator [pageIndex]="currentPage" [hidePageSize]="true" [pageSize]="dataSource?.data?.length"  [showFirstLastButtons]="false"
                   (page)="pageEvent = handlePage($event)"
                   aria-label="Select page of periodic elements" >
    </mat-paginator>
  </div>
</div>
